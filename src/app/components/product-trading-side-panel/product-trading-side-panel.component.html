<!-- Side Panel Overlay -->
<div class="side-panel-overlay" [class.show]="isOpen" (click)="onClose()"></div>

<!-- Side Panel -->
<div class="side-panel" [class.open]="isOpen">
  <div class="side-panel-header">
    <h5 class="mb-0 text-primary fw-bold">
      <i class="bi bi-graph-up-arrow me-2"></i>
      Product Trading Statistics
    </h5>
    <button type="button" class="btn-close" (click)="onClose()" aria-label="Close"></button>
  </div>

  <div class="side-panel-body">
    <!-- Product Info -->
    <div *ngIf="selectedProduct" class="product-info-card mb-4">
      <div class="card border-primary">
        <div class="card-header bg-primary text-white">
          <h6 class="mb-0">
            <i class="bi bi-box-seam me-2"></i>
            {{ selectedProduct.name }}
          </h6>
        </div>
        <div class="card-body">
          <p class="card-text text-muted mb-0">
            <small>{{ selectedProduct.description }}</small>
          </p>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3 text-muted">Loading trading statistics...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="alert alert-danger d-flex align-items-center" role="alert">
      <i class="bi bi-exclamation-triangle-fill me-2"></i>
      <div>{{ error }}</div>
    </div>

    <!-- Statistics Cards -->
    <div *ngIf="!loading && !error" class="statistics-container">
      <!-- Total Amount Traded Card -->
      <div class="card mb-3 border-success">
        <div class="card-header bg-success text-white">
          <h6 class="mb-0">
            <i class="bi bi-currency-dollar me-2"></i>
            Total Amount Traded
          </h6>
        </div>
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h3 class="text-success mb-1 fw-bold">₹{{ totalAmount | number:'1.2-2' }}</h3>
              <small class="text-muted">{{ amountMessage }}</small>
            </div>
            <div class="stat-icon">
              <i class="bi bi-cash-stack text-success"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Total Volume Traded Card -->
      <div class="card mb-3 border-info">
        <div class="card-header bg-info text-white">
          <h6 class="mb-0">
            <i class="bi bi-bar-chart-fill me-2"></i>
            Total Volume Traded
          </h6>
        </div>
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h3 class="text-info mb-1 fw-bold">{{ totalVolume | number }}</h3>
              <small class="text-muted">{{ volumeMessage }}</small>
            </div>
            <div class="stat-icon">
              <i class="bi bi-boxes text-info"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Additional Info Card -->
      <div class="card border-secondary">
        <div class="card-header bg-secondary text-white">
          <h6 class="mb-0">
            <i class="bi bi-info-circle me-2"></i>
            Summary
          </h6>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-6">
              <div class="text-center">
                <div class="text-muted small">Average per Unit</div>
                <div class="fw-bold text-secondary">
                  ₹{{ totalVolume > 0 ? (totalAmount / totalVolume) : 0 | number:'1.2-2' }}
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="text-center">
                <div class="text-muted small">Status</div>
                <div class="fw-bold text-secondary">
                  {{ totalAmount > 0 || totalVolume > 0 ? 'Active' : 'No Trading' }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Refresh Button -->
    <div class="mt-4 text-center">
      <button 
        class="btn btn-outline-primary" 
        (click)="refreshData()"
        [disabled]="loading">
        <i class="bi bi-arrow-clockwise me-2"></i>
        Refresh Data
      </button>
    </div>
  </div>
</div>