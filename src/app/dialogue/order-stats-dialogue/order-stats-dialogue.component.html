<div class="dialog-container">
  <div class="dialog-header d-flex justify-content-between align-items-center mb-3">
    <h4 class="modal-title text-primary fw-bold mb-0">
      <i class="bi bi-bar-chart-fill me-2"></i>Order Statistics
    </h4>
    <button 
      type="button" 
      class="btn-close" 
      (click)="onClose()" 
      aria-label="Close">
    </button>
  </div>

  <div class="dialog-body">
    <!-- Total Orders Summary -->
    <div class="alert alert-info d-flex align-items-center mb-4">
      <i class="bi bi-info-circle-fill me-2"></i>
      <div>
        <strong>Total Orders:</strong> {{ data.totalOrders }}
      </div>
    </div>

    <!-- Order Status Statistics -->
    <div class="order-stats">
      <h6 class="text-secondary mb-3">Distribution by Status:</h6>
      
      <div class="row">
        <div 
          *ngFor="let statusCount of getVisibleStatusCounts()" 
          class="col-md-6 mb-3">
          
          <div class="status-card border rounded p-3">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <div class="status-info d-flex align-items-center">
                <i [class]="getStatusIcon(statusCount.status) + ' me-2 text-muted'"></i>
                <span [class]="'badge ' + getStatusColor(statusCount.status) + ' me-2'">
                  {{ formatStatusName(statusCount.status) }}
                </span>
                <span class="fw-bold">{{ statusCount.count }}</span>
              </div>
              <span class="text-muted small">
                {{ getPercentage(statusCount.count) | number:'1.1-1' }}%
              </span>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress" style="height: 6px;">
              <div 
                [class]="'progress-bar ' + getStatusColor(statusCount.status)"
                role="progressbar" 
                [style.width.%]="getPercentage(statusCount.count)"
                [attr.aria-valuenow]="getPercentage(statusCount.count)"
                aria-valuemin="0" 
                aria-valuemax="100">
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Active Orders Summary -->
      <div class="mt-4">
        <div class="row">
          <div class="col-md-4">
            <div class="summary-card text-center p-3 border rounded bg-light">
              <h6 class="text-primary">Active Orders</h6>
              <h4 class="fw-bold text-primary">
                {{ getActiveOrdersCount() }}
              </h4>
              <small class="text-muted">Placed + Accepted</small>
            </div>
          </div>
          <div class="col-md-4">
            <div class="summary-card text-center p-3 border rounded bg-light">
              <h6 class="text-success">Completed</h6>
              <h4 class="fw-bold text-success">
                {{ getCompletedOrdersCount() }}
              </h4>
              <small class="text-muted">Delivered + Successful</small>
            </div>
          </div>
          <div class="col-md-4">
            <div class="summary-card text-center p-3 border rounded bg-light">
              <h6 class="text-danger">Issues</h6>
              <h4 class="fw-bold text-danger">
                {{ getIssueOrdersCount() }}
              </h4>
              <small class="text-muted">Rejected + Cancelled</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Detailed Breakdown (Optional) -->
      <div class="mt-4" *ngIf="data.statusCounts && data.statusCounts.length > 0">
        <h6 class="text-secondary mb-3">Detailed Breakdown:</h6>
        <div class="row">
          <div class="col-md-6">
            <div class="card border-0 bg-light">
              <div class="card-body">
                <h6 class="card-title text-primary">
                  <i class="bi bi-hourglass-split me-2"></i>In Progress
                </h6>
                <ul class="list-unstyled mb-0">
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('PLACED') > 0">
                    <span>Placed:</span>
                    <span class="fw-bold">{{ getStatusCount('PLACED') }}</span>
                  </li>
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('ACCEPTED') > 0">
                    <span>Accepted:</span>
                    <span class="fw-bold">{{ getStatusCount('ACCEPTED') }}</span>
                  </li>
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('CONFIRMED') > 0">
                    <span>Confirmed:</span>
                    <span class="fw-bold">{{ getStatusCount('CONFIRMED') }}</span>
                  </li>
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('INTRANSIT') > 0">
                    <span>In Transit:</span>
                    <span class="fw-bold">{{ getStatusCount('INTRANSIT') }}</span>
                  </li>
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('PENDING') > 0">
                    <span>Pending:</span>
                    <span class="fw-bold">{{ getStatusCount('PENDING') }}</span>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card border-0 bg-light">
              <div class="card-body">
                <h6 class="card-title text-success">
                  <i class="bi bi-check-circle me-2"></i>Final Status
                </h6>
                <ul class="list-unstyled mb-0">
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('DELIVERED') > 0">
                    <span>Delivered:</span>
                    <span class="fw-bold text-success">{{ getStatusCount('DELIVERED') }}</span>
                  </li>
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('SUCCESFULL') > 0">
                    <span>Successful:</span>
                    <span class="fw-bold text-success">{{ getStatusCount('SUCCESFULL') }}</span>
                  </li>
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('REJECTED') > 0">
                    <span>Rejected:</span>
                    <span class="fw-bold text-danger">{{ getStatusCount('REJECTED') }}</span>
                  </li>
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('CANCELLED') > 0">
                    <span>Cancelled:</span>
                    <span class="fw-bold text-danger">{{ getStatusCount('CANCELLED') }}</span>
                  </li>
                  <li class="d-flex justify-content-between" *ngIf="getStatusCount('REFUNDED') > 0">
                    <span>Refunded:</span>
                    <span class="fw-bold text-warning">{{ getStatusCount('REFUNDED') }}</span>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- No Data State -->
      <div *ngIf="!data.statusCounts || data.statusCounts.length === 0" class="text-center py-4">
        <i class="bi bi-inbox text-muted" style="font-size: 2rem;"></i>
        <p class="text-muted mt-2">No order data available</p>
      </div>
    </div>
  </div>

  <div class="dialog-footer mt-4">
    <button 
      type="button" 
      class="btn btn-secondary" 
      (click)="onClose()">
      Close
    </button>
  </div>
</div>
